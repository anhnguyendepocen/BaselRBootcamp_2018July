<!DOCTYPE html>
<html>
  <head>
    <title>Dynamic Reports</title>
    <meta charset="utf-8">
    <meta name="author" content="Basel R Bootcamp www.therbootcamp.com @therbootcamp" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="baselrbootcamp.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Dynamic Reports
## with R Markdown
### Basel R Bootcamp<br/><a href='https://therbootcamp.github.io'>www.therbootcamp.com</a><br/><a href='https://twitter.com/therbootcamp'><span class="citation">@therbootcamp</span></a>
### July 2018

---


layout: true

&lt;div class="my-footer"&gt;&lt;span&gt;
&lt;a href="https://therbootcamp.github.io/"&gt;&lt;font color="#7E7E7E"&gt;BaselRBootcamp, July 2018&lt;/font&gt;&lt;/a&gt;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;a href="https://therbootcamp.github.io/"&gt;&lt;font color="#7E7E7E"&gt;www.therbootcamp.com&lt;/font&gt;&lt;/a&gt;
&lt;/span&gt;&lt;/div&gt; 

---






&lt;br&gt;&lt;br&gt;

&gt; #How do you get your analyses into a final report?

---
##A typical Analysis -&gt; Document workflow
&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/unreproducible_workflow.png" style="display: block; margin: auto;" /&gt;


---


.pull-left5[
&lt;br&gt;&lt;br&gt;
## What is wrong?

Many opportunities for &lt;high&gt;human error&lt;/high&gt; in transferring results.

&gt; Wait is the p-value .07 or 0.70?

&lt;high&gt;No documentation&lt;/high&gt; on exactly how the analysis was conducted. 

&gt; How did I exactly do that analysis again??

&lt;high&gt;Slow&lt;/high&gt; 
&gt; You want me to do that analysis again with new data?! Do you know how long that took me?!

### The solution? A Dynamic Report

]

.pull-right45[
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/unreproducible_workflow.png" style="display: block; margin: auto;" /&gt;

]



---
## Dynamic report

A &lt;high&gt;Dynamic Report&lt;/high&gt; &lt;u&gt;automatically generates&lt;/u&gt; output from a combination of data, code, images, and text.

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/DynamicReports_ProcessHorizontal.png" style="display: block; margin: auto;" /&gt;

---

.pull-left55[

## Why are dynamic reports great?

&lt;br&gt;
&lt;high&gt;Accurate&lt;/high&gt;

- Statistical output are never mistyped
- The code *must* be correct because it is being run as the report is created.

&lt;high&gt;Reproducible&lt;/high&gt;

- All processes are contained in code that anyone can see and run.
- The code *must* be correct because it is evaluated as the report is created.
- Original data is always connected to the final output

&lt;high&gt;Efficient&lt;/high&gt;

- If you get new data, you can easily repeat your analyses with one click!


]

.pull-right45[

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/DynamicReports_ProcessVertical.png" width="80%" style="display: block; margin: auto;" /&gt;




]


---

## What dynamic reports can I make in R?

.pull-left45[
&lt;br&gt;&lt;br&gt;

|  | |
|:------|:------|
|Web (HTML) pages |[Websites from Markdown](http://rmarkdown.rstudio.com/rmarkdown_websites.html) |
|PDF documents | [PDFs from Markdown](http://rmarkdown.rstudio.com/pdf_document_format.html) |
|Slideshows | [Slide Ninja from xaringan!](https://github.com/yihui/xaringan) |
|Shiny Apps | [https://shiny.rstudio.com/](https://shiny.rstudio.com/) |
|Books | [bookdown.org](http://bookdown.org) |
|R Packages | [Wickham package writing guide](http://r-pkgs.had.co.nz/) |


### Underneath everything...

# R Markdown

]

.pull-right45[


&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/RMarkdownOutputFormats.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## What is Markdown (.md)?

Markdown is a simple, readable markup &lt;high&gt;language&lt;/high&gt; that allows you to easily write text with special &lt;high&gt;formatting tags&lt;/high&gt;, which are then converted to formatted outputs.


&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/DynamicReports_BasicMarkdown.png" width="90%" style="display: block; margin: auto;" /&gt;



---

## What is RMarkdown (.Rmd)?

&lt;high&gt;RMarkdown&lt;/high&gt; is a combination of standard markdown combined with &lt;high&gt;R Code&lt;/high&gt;


&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/DynamicReports_BasicRMarkdown.png" width="90%" style="display: block; margin: auto;" /&gt;


---

## How do I write an R Markdown Document

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/openmarkdown.png" width="80%" style="display: block; margin: auto;" /&gt;


---

## Code Chunks in R Markdown


.pull-left4[

Incorporate code in your document in &lt;high&gt;code chunks&lt;/high&gt;

Everything in a code chunk will be evaluated when you "knit" the document

Each chunk can have arguments

|Argument| Description|
|:-----|:------|
|`eval` |Should the code be evaluated? |
|`echo` |Should the code be shown? |
|`fig.width, fig.height`| Figure sizes|


See a list of all chunk options at Yihui's site [here](https://yihui.name/knitr/options/)

]

.pull-right55[

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/chunkoptions.png" width="90%" style="display: block; margin: auto;" /&gt;


]
---

# Inline chunks

You can include *inline chunks* where R code is included in a sentence. This allows you to include R output in your text!

&lt;br&gt;
&lt;br&gt;

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/minichunk_ss_D.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## Inline chunks

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/minichunk_big_ss.png" width="100%" style="display: block; margin: auto;" /&gt;




---


.pull-left4[

&lt;br&gt;&lt;br&gt;
# Keep your project tidy!

&lt;br&gt;


1. Easily read in external files like images, R code, or datasets in your R Markdown document.

2. All raw data files (.csv, .sav, etc) should be in a folder (e.g.; `1_Data`) in your R Project directory

3. Keep other files such as images (.jpg, .png) in another well named folder (e.g.; `0_Materials` or `4_Images`)
&lt;br&gt;&lt;br&gt;


]

.pull-right55[
&lt;br&gt;&lt;br&gt;

&lt;center&gt;&lt;h3&gt;Everything in your project!!&lt;/h3&gt;
&lt;center&gt;&lt;high&gt;Every&lt;/high&gt; file (data, images) necessary to create your RMarkdown document should be somewhere &lt;high&gt;in your R project folder&lt;/high&gt;!

&lt;img src="https://github.com/therbootcamp/therbootcamp.github.io/blob/master/_sessions/_image/DynamicReports_ProjectStructure.png?raw=true" width="100%" style="display: block; margin: auto;" /&gt;

]

---
## Your code must be complete!

When you knit a Markdown file, R will &lt;high&gt;forget&lt;/high&gt; everything you've done and &lt;high&gt;start from scratch&lt;/high&gt; 

You must &lt;high&gt;load all packages&lt;/high&gt; with `library()` and &lt;high&gt;define all objects&lt;/high&gt;

&lt;img src="https://github.com/therbootcamp/therbootcamp.github.io/blob/master/_sessions/_image/DynamicReports_badknit.png?raw=true" width="95%" style="display: block; margin: auto;" /&gt;


---
## Your code must be complete!

When you knit a Markdown file, R will &lt;high&gt;forget&lt;/high&gt; everything you've done and &lt;high&gt;start from scratch&lt;/high&gt; 

You must &lt;high&gt;load all packages&lt;/high&gt; with `library()` and &lt;high&gt;define all objects&lt;/high&gt;

&lt;img src="https://github.com/therbootcamp/therbootcamp.github.io/blob/master/_sessions/_image/DynamicReports_goodknit.png?raw=true" width="95%" style="display: block; margin: auto;" /&gt;


---

## Keep your code complete and tidy

.pull-left45[

Don't include unnecessary code like random calculations or package installation.

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/DynamicReports_BadMarkdown.png" width="100%" style="display: block; margin: auto;" /&gt;

]

.pull-right45[

If you want to save some code for you, comment it out with \#

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/DynamicReports_GoodMarkdown.png" width="100%" style="display: block; margin: auto;" /&gt;

]




---

## Rendering output with `knitr`

.pull-left45[

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/knitr_hex.png" width="30%" style="display: block; margin: auto;" /&gt;

Non-text ouputs such as images and tables need to be &lt;u&gt;rendered&lt;/u&gt; using functions from the amazing &lt;high&gt;knitr&lt;/high&gt; package.


```r
# Load the knitr package
library(knitr)
```


| Function|Output|
|:------|:----|
|     `kable(df, format)`|Print a dataframe as a table|
|     `include_graphics(path)`| Include an image (e.g.; .png, .jpg)|

]

.pull-right5[

Render a table with &lt;high&gt;kable()&lt;/high&gt;


```r
kable(x = baselers,  # A data frame
      format = 'markdown')
```


| id|sex    | age| height| weight| income|
|--:|:------|---:|------:|------:|------:|
|  1|male   |  44|  174.3|  113.4|   6300|
|  2|male   |  65|  180.3|   75.2|  10900|
|  3|female |  31|  168.3|   55.5|   5100|


Render an image with &lt;high&gt;include_graphics()&lt;/high&gt;


```r
include_graphics(path = "images/rlogo.png")
```

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/rlogo.png" width="30%" style="display: block; margin: auto;" /&gt;

]


---

## Managing working directories with RMarkdown

When you knit `Markdown.Rmd`, the working directory will be *changed to the location of* `Markdown.Rmd`.

.pull-left45[

Situation 1: Markdown.Rmd is in the &lt;high&gt;same folder&lt;/high&gt; as `*.Rproj`

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/DynamicReports_SameFolder.png" width="70%" style="display: block; margin: auto;" /&gt;


```r
# Load data from 1_Data folder
read_csv(file = "1_Data/baselers.csv")
```

Can read data normally because `Markdown.Rmd` is in the same folder as the project.


]

.pull-right45[

Situation 2: Markdown.Rmd is in a &lt;high&gt;sub folder&lt;/high&gt; (e.g.; `4_Markdown`)


&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/DynamicReports_SubFolder.png" width="70%" style="display: block; margin: auto;" /&gt;


```r
# Load data from 1_Data folder
read_csv(file = "../1_Data/baselers.csv")
```

Must include `../` in your path to tell Markdown that the project directory is one folder 'up'

]


---

## Managing working directories with RMarkdown

.pull-left45[

If your `MyMarkdown.Rmd` file is in a sub folder like `4_Markdown`...

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/DynamicReports_SubFolder.png" width="70%" style="display: block; margin: auto;" /&gt;

Include the following code &lt;high&gt;in the first chunk&lt;/high&gt; to tell Markdown that the main project directory is &lt;high&gt;one folder "up"&lt;/high&gt;


```r
# Fix working directory issue
knitr::opts_knit$set(root.dir = "../")
```

]

.pull-right5[
&lt;br&gt;&lt;br&gt;
Loading files &lt;high&gt;without&lt;/high&gt; root directory fix


```r
library(tidyverse)

baselers &lt;- read_csv("../1_Data/baselers.csv")
chickens &lt;- read_csv("../1_Data/chickens.csv")
```

Loading files &lt;high&gt;with&lt;/high&gt; root directory fix

&lt;i&gt;Recommended!&lt;/i&gt;


```r
# Fix working directory issue
knitr::opts_knit$set(root.dir = "../")

library(tidyverse)

baselers &lt;- read_csv("1_Data/baselers.csv")
chickens &lt;- read_csv("1_Data/chickens.csv")
```




]





---

.pull-left4[
&lt;br&gt;&lt;br&gt;
## Output types

There are *many* different output formats you can create from an R Markdown document

Many come with RStudio, many are distributed in packages:

| Package|Description|
|:------|:----|
|     `xaringan`*| Slideshows (like this one!)|
|     `papaja`*|APA Manuscripts|
|     `rmdformats`|Many templates|
|     `prettydoc`|Many templates|

* = On GitHub

]

.pull-right55[
&lt;br&gt;
### R Markdown templates in R Studio

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/rmarkdown_templates.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## R Markdown Gallery

http://rmarkdown.rstudio.com/gallery.html

&lt;iframe src="rmarkdown_gallery.htm" width="800" height="450"&gt;&lt;/iframe&gt;


---

## Why are dynamic documents so great?

.pull-left6[


1. &lt;high&gt;Tidy!&lt;/high&gt; Data, code, and output are all in the same place.

2. Everything works and is &lt;high&gt;replicable&lt;/high&gt;!

3. You can produce &lt;high&gt;great looking documents&lt;/high&gt;, from simple PDFs, to webpages, to presentations (like this one!).

4. &lt;high&gt;Update your documents&lt;/high&gt; with new data with just one line of code!


&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/RMarkdownOutputFormats.png" width="50%" style="display: block; margin: auto;" /&gt;



]

.pull-right35[
&lt;br&gt;
&lt;center&gt;&lt;a href="https://bookdown.org/yihui/rmarkdown/"&gt;&lt;img src="https://bookdown.org/yihui/rmarkdown/images/cover.png" width="250"&gt;&lt;/a&gt;

[Yihui Xie's free R Markdown guide](https://bookdown.org/yihui/rmarkdown/)


]




---
# Questions?

# [Dynamic Reports Practical](https://therbootcamp.github.io/Erfurt_2018June/_sessions/D2S4_DynamicReports/DynamicReports_practical.html)

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/minichunk_big_ss.png" width="80%" style="display: block; margin: auto;" /&gt;



---
# Additional Slides

---

## R Packages - The ultimate dynamic report?

.pull-left55[

If you want a fully contained, dynamic report that contains data, code, statistics, plots, text, help files and documentation that you can easily share, your answer may be creating an **R Package**.

#### Installing an example package from GitHub


```r
library(devtools) # For the install_github function

# Install DrugX_2018_Trial package from github
install_github("bootcamp/DrugX_2018_Trial")

# Load DrugX_2018_Trial package
library("DrugX_2018_Trial")

# Open DrugX_2018_Trial package help
?DrugX_2018_Trial
```

]

.pull-right4[

### Package folder structure

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/phillips2017_package_ss.png" width="100%" style="display: block; margin: auto;" /&gt;

&lt;br&gt;

Read Wickham's [book "R Packages"](http://r-pkgs.had.co.nz/) (available free at this link) to learn how to write your own package.

]



---

## To write to PDF, you need TeX

.pull-left3[


RMarkdown uses LaTeX to create PDF files

In order to knit your document to a PDF, you'll need a TeX installation on your machine.

| OS | Link |
|:---|:----|
|Windows| MiKTeX [https://miktex.org/download](https://miktex.org/download)
|Mac| MacTeX [http://www.tug.org/mactex/](http://www.tug.org/mactex/)


]

.pull-right65[

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/latex_collage.png" width="70%" style="display: block; margin: auto;" /&gt;

]



---

## Code Chunks in R Markdown

You can set default chunk options with `ops_chunk$set()`. When you do, all future chunks will have these settings (unless you specify otherwise)


```r
# Example: Set default values for ALL future chunks
#   with knitr::ops_chunk$set


knitr::opts_chunk$set(fig.width = 6,        # Figure width (in)
                      fig.height = 6,       # Figure height (in)
                      echo = TRUE,          # Repeat code
                      eval = TRUE,          # Evaluate chunks
                      message = FALSE,      # Don't print messages
                      warning = FALSE,      # Don't print warnings
                      fig.align = 'center') # Center figures
```

We recommend setting chunk options at the beginning of each document!
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
